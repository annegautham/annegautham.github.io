---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";

const notes = await getCollection("notes");

const categories = Array.from(
  new Map(
    notes.map(note => {
      const slugParts = note.slug.split("/");
      return [slugParts[0], note];
    })
  ).values()
);
---

<Layout title="Notes">
  <Header activeNav="notes" />
  <main class="max-w-3xl mx-auto py-8">
    <h1 class="text-4xl font-bold mb-8">Notes</h1>
    <div class="space-y-4">
      {
        categories.map(({ slug, data }) => (
          <a
            href={`/notes/${slug.split("/")[0]}/`}
            class="block border rounded-lg p-4 hover:bg-skin-fill bg-skin-card border-skin-accent"
          >
            <h2 class="font-bold text-xl mb-1">{data.title}</h2>
            <p class="opacity-80 text-sm">
              {data.description ?? "No description yet."}
            </p>
          </a>
        ))
      }
    </div>
  </main>
  <Footer />
</Layout>
